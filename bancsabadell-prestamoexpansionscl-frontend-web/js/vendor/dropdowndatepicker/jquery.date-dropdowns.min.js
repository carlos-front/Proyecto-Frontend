!function(e,t,n,a){"use strict";function i(t,n){return this.element=t,this.$element=e(t),this.config=e.extend({},s,n),this.internals={objectRefs:{}},this.init(),this}var r="dateDropdowns",s={defaultDate:null,defaultDateFormat:"yyyy-mm-dd",displayFormat:"dmy",submitFormat:"yyyy-mm-dd",minAge:0,maxAge:120,minYear:null,maxYear:null,submitFieldName:"date",wrapperClass:"date-dropdowns",dropdownClass:null,daySuffixes:!0,monthSuffixes:!0,monthFormat:"long",required:!1,language:"en"};i.message={day:"DD",month:"MM",year:"YYYY"},e.extend(i.prototype,{init:function(){this.checkForDuplicateElement(),this.setInternalVariables(this.config.language),this.setupMarkup(),this.buildDropdowns(),this.attachDropdowns(),this.bindChangeEvent(),this.config.defaultDate&&this.populateDefaultDate()},checkForDuplicateElement:function(){return e('input[name="'+this.config.submitFieldName+'"]').length?(e.error("Duplicate element found"),!1):!0},setInternalVariables:function(e){var t=new Date;this.internals.currentDay=t.getDate(),this.internals.currentMonth=t.getMonth()+1,this.internals.currentYear=t.getFullYear(),"en"==e?(this.internals.monthShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.internals.monthLong=["January","February","March","April","May","June","July","August","September","October","November","December"]):"es"==e?(this.internals.monthShort=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],this.internals.monthLong=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]):"ca"==e&&(this.internals.monthShort=["Gen","Feb","Mar","Abr","Mai","Jun","Jul","Ago","Set","Oct","Nov","Des"],this.internals.monthLong=["Gener","Febrer","Mar√ß","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"])},setupMarkup:function(){var t,n;if("input"===this.element.tagName.toLowerCase()){this.config.defaultDate||(this.config.defaultDate=this.element.value),n=this.$element.attr("type","hidden").wrap('<div class="'+this.config.wrapperClass+'"></div>');var a=this.config.submitFieldName!==s.submitFieldName,i=this.element.hasAttribute("name");i||a?a&&this.$element.attr("name",this.config.submitFieldName):this.$element.attr("name",s.submitFieldName),t=this.$element.parent()}else n=e("<input/>",{type:"hidden",name:this.config.submitFieldName}),this.$element.append(n).addClass(this.config.wrapperClass),t=this.$element;return this.internals.objectRefs.pluginWrapper=t,this.internals.objectRefs.hiddenField=n,!0},buildDropdowns:function(){var e,t,n;return e=this.buildDayDropdown(),this.internals.objectRefs.dayDropdown=e,t=this.buildMonthDropdown(),this.internals.objectRefs.monthDropdown=t,n=this.buildYearDropdown(),this.internals.objectRefs.yearDropdown=n,!0},attachDropdowns:function(){var e=this.internals.objectRefs.pluginWrapper,t=this.internals.objectRefs.dayDropdown,n=this.internals.objectRefs.monthDropdown,a=this.internals.objectRefs.yearDropdown;switch(this.config.displayFormat){case"mdy":e.append(n,t,a);break;case"ymd":e.append(a,n,t);break;case"dmy":default:e.append(t,n,a)}return!0},bindChangeEvent:function(){var e=this.internals.objectRefs.dayDropdown,t=this.internals.objectRefs.monthDropdown,n=this.internals.objectRefs.yearDropdown,a=this,i=this.internals.objectRefs;i.pluginWrapper.on("change","select",function(){var r,s,o=e.val(),l=t.val(),d=n.val();return(r=a.checkDate(o,l,d))?(i.dayDropdown.addClass("invalid"),!1):("00"!==i.dayDropdown.val()&&i.dayDropdown.removeClass("invalid"),i.hiddenField.val(""),r||o*l*d===0||(s=a.formatSubmitDate(o,l,d),i.hiddenField.val(s)),void i.hiddenField.change())})},populateDefaultDate:function(){var e=this.config.defaultDate,t=[],n="",a="",i="";switch(this.config.defaultDateFormat){case"yyyy-mm-dd":default:t=e.split("-"),n=t[2],a=t[1],i=t[0];break;case"dd/mm/yyyy":t=e.split("/"),n=t[0],a=t[1],i=t[2];break;case"mm/dd/yyyy":t=e.split("/"),n=t[1],a=t[0],i=t[2];break;case"unix":t=new Date,t.setTime(1e3*e),n=t.getDate()+"",a=t.getMonth()+1+"",i=t.getFullYear(),n.length<2&&(n="0"+n),a.length<2&&(a="0"+a)}return this.internals.objectRefs.dayDropdown.val(n),this.internals.objectRefs.monthDropdown.val(a),this.internals.objectRefs.yearDropdown.val(i),this.internals.objectRefs.hiddenField.val(e),!0===this.checkDate(n,a,i)&&this.internals.objectRefs.dayDropdown.addClass("invalid"),!0},buildBaseDropdown:function(t){var n=t;return this.config.dropdownClass&&(n+=" "+this.config.dropdownClass),e("<select></select>",{"class":n,name:this.config.submitFieldName+"_["+t+"]",required:this.config.required})},buildDayDropdown:function(){var e,t=this.buildBaseDropdown("day"),a=n.createElement("option");a.setAttribute("value",""),a.appendChild(n.createTextNode(i.message.day)),t.append(a);for(var r=1;10>r;r++)e=this.config.daySuffixes?r+this.getSuffix(r):"0"+r,a=n.createElement("option"),a.setAttribute("value","0"+r),a.appendChild(n.createTextNode(e)),t.append(a);for(var s=10;31>=s;s++)e=s,this.config.daySuffixes&&(e=s+this.getSuffix(s)),a=n.createElement("option"),a.setAttribute("value",s),a.appendChild(n.createTextNode(e)),t.append(a);return t},buildMonthDropdown:function(){var e=this.buildBaseDropdown("month"),t=n.createElement("option");t.setAttribute("value",""),t.appendChild(n.createTextNode(i.message.month)),e.append(t);for(var a=1;12>=a;a++){var r;switch(this.config.monthFormat){case"short":r=this.internals.monthShort[a-1];break;case"long":r=this.internals.monthLong[a-1];break;case"numeric":r=a,this.config.monthSuffixes&&(r+=this.getSuffix(a))}10>a&&(a="0"+a),t=n.createElement("option"),t.setAttribute("value",a),t.appendChild(n.createTextNode(r)),e.append(t)}return e},buildYearDropdown:function(){var e=this.config.minYear,t=this.config.maxYear,a=this.buildBaseDropdown("year"),r=n.createElement("option");r.setAttribute("value",""),r.appendChild(n.createTextNode(i.message.year)),a.append(r),e||(e=this.internals.currentYear-(this.config.maxAge+1)),t||(t=this.internals.currentYear-this.config.minAge);for(var s=t;s>=e;s--)r=n.createElement("option"),r.setAttribute("value",s),r.appendChild(n.createTextNode(s)),a.append(r);return a},getSuffix:function(e){var t="";switch(e%10){case 1:t=e%100===11?"th":"st";break;case 2:t=e%100===12?"th":"nd";break;case 3:t=e%100===13?"th":"rd";break;default:t="th"}return t},checkDate:function(e,t,n){var a;if("00"!==t){var i=new Date(n,t,0).getDate(),r=parseInt(e,10);a=this.updateDayOptions(i,r),a&&this.internals.objectRefs.hiddenField.val("")}return a},updateDayOptions:function(e,t){var a=parseInt(this.internals.objectRefs.dayDropdown.children(":last").val(),10),i="",r="",s=!1;if(a>e){for(;a>e;)this.internals.objectRefs.dayDropdown.children(":last").remove(),a--;t>e&&(s=!0)}else if(e>a)for(;e>a;){i=++a,r=i,this.config.daySuffixes&&(r+=this.getSuffix(a));var o=n.createElement("option");o.setAttribute("value",i),o.appendChild(n.createTextNode(r)),this.internals.objectRefs.dayDropdown.append(o)}return s},formatSubmitDate:function(e,t,n){var a,i;switch(this.config.submitFormat){case"unix":i=new Date,i.setDate(e),i.setMonth(t-1),i.setYear(n),a=Math.round(i.getTime()/1e3);break;default:a=this.config.submitFormat.replace("dd",e).replace("mm",t).replace("yyyy",n)}return a},destroy:function(){var e=this.config.wrapperClass;if(this.$element.hasClass(e))this.$element.empty();else{var t=this.$element.parent(),n=t.find("select");this.$element.unwrap(),n.remove()}}}),e.fn[r]=function(t){return this.each(function(){if("string"==typeof t){var n=Array.prototype.slice.call(arguments,1),a=e.data(this,"plugin_"+r);if("undefined"==typeof a)return e.error("Please initialize the plugin before calling this method."),!1;a[t].apply(a,n)}else e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new i(this,t))}),this}}(jQuery,window,document);